<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A tool for simulating multi-response linear model data</title>
  <meta name="description" content="A tool for simulating multi-response linear model data">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="A tool for simulating multi-response linear model data" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://therimalaya.github.io/simrel-m" />
  
  
  <meta name="github-repo" content="therimalaya/simrel-m" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A tool for simulating multi-response linear model data" />
  
  
  



<meta name="date" content="2017-10-31">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="relevant-components.html">
<link rel="next" href="web-interface.html">
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="lead"><a href="./index.html">Simrel-M: A versatile Simulation Tool</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="statistical-model.html"><a href="statistical-model.html"><i class="fa fa-check"></i>Statistical Model</a></li>
<li class="chapter" data-level="" data-path="relevant-components.html"><a href="relevant-components.html"><i class="fa fa-check"></i>Relevant Components</a><ul>
<li class="chapter" data-level="" data-path="relevant-components.html"><a href="relevant-components.html#model-parameterization"><i class="fa fa-check"></i>Model Parameterization</a><ul>
<li class="chapter" data-level="" data-path="relevant-components.html"><a href="relevant-components.html#position-of-relevant-components"><i class="fa fa-check"></i>Position of relevant components</a></li>
<li class="chapter" data-level="" data-path="relevant-components.html"><a href="relevant-components.html#data-simulation"><i class="fa fa-check"></i>Data Simulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="relevant-components.html"><a href="relevant-components.html#rotation-of-predictor-space"><i class="fa fa-check"></i>Rotation of predictor space</a></li>
<li class="chapter" data-level="" data-path="relevant-components.html"><a href="relevant-components.html#rotation-of-response-space"><i class="fa fa-check"></i>Rotation of response space</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="implementation.html"><a href="implementation.html"><i class="fa fa-check"></i>Implementation</a></li>
<li class="chapter" data-level="" data-path="web-interface.html"><a href="web-interface.html"><i class="fa fa-check"></i>Web Interface</a></li>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i>Conclusion</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li class="toc-footer"><a href="https://bookdown.org" target="blank">Published with BookDown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A tool for simulating multi-response linear model data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="implementation" class="section level1">
<h1>Implementation</h1>
<p>This section demonstrates an application of multi-response extension of <code>simrel</code> in order to compare different estimation methods on the basis of prediction error. For the comparison, we have considered four well established estimation methods.</p>
<ol style="list-style-type: lower-alpha">
<li>Ordinary Least Squares (OLS),</li>
<li>Principal Component Regression (PCR),</li>
<li>Partial Least Squares predicting individual response variable separately (PLS1) and</li>
<li>Partial Least Squares predicting all response variables together (PLS2).</li>
</ol>
<p>We have also considered four relatively new estimation methods in multi-response regression:</p>
<ol style="list-style-type: lower-alpha">
<li>Canonically Powered Partial Least Squares regression (CPPLS) <span class="citation">(Indahl, Liland, and Næs 2009)</span>,</li>
<li>Canonical Partial Least Squares regression (CPLS) <span class="citation">(Indahl, Liland, and Næs 2009)</span>,</li>
<li>Envelope estimation in predictor space (Xenv) <span class="citation">(Cook, Li, and Chiaromonte 2010)</span>,</li>
<li>Envelope estimation in response space (Yenv) <span class="citation">(R Dennis Cook and Zhang 2015)</span> and</li>
<li>Simultaneous estimation of x- and y-envelope (Senv) <span class="citation">(R. Dennis Cook and Zhang 2015)</span></li>
</ol>
<p>From the possible combinations of two levels of coefficient of determination <span class="math inline">\((R^2)\)</span> and two levels of <span class="math inline">\(\gamma\)</span> <a href="relevant-components.html#eq:gamma-parameter">(6)</a> (the factor that controls the multicollinearity in predictor variables), four simulation designs (design 1-4) were prepared. Replicating each design 20 times, 80 datasets with five response variables <span class="math inline">\((m=5)\)</span> and 16 predictor variables <span class="math inline">\((p = 16)\)</span> were simulated using the method discussed in this paper. It was also assumed that three principle components of response variables (<span class="math inline">\(w_1, w_2\)</span> and <span class="math inline">\(w_3\)</span>) completely describe the variation present in five response variables (<span class="math inline">\(y_1 \ldots y_5\)</span>). Here, in this example we have assumed that all <span class="math inline">\(w\)</span>’s have equal variance, i.e. <span class="math inline">\(\Sigma_{ww} = \mathbf{I}_m\)</span>. The four designs are presented in Table~<a href="implementation.html#tab:parameter-settings">1</a>. All datasets contained 100 sampled observations and out of 16 predictor variables, three disjoint set of five predictor variables are relevant for response components <span class="math inline">\(w_1, w_2\)</span> and <span class="math inline">\(w_3\)</span>. Although the simulation method is well equipped to simulate data with <span class="math inline">\(p \gg n\)</span>, for incorporating envelope estimation methods which are based on maximization of likelihood, we have chosen <span class="math inline">\(n &gt; p\)</span> situation in the example. Further, predictor components <span class="math inline">\(z_1\)</span> and <span class="math inline">\(z_6\)</span> were relevant for response component <span class="math inline">\(w_1\)</span>, predictor components <span class="math inline">\(z_2\)</span> and <span class="math inline">\(z_5\)</span> were relevant for response component <span class="math inline">\(w_2\)</span> and predictor component <span class="math inline">\(z_3\)</span> and <span class="math inline">\(z_4\)</span> was relevant for response component <span class="math inline">\(w_3\)</span>. In addition, following the discussion about <a href="relevant-components.html#rotation-of-response-space">rotation of response space</a>, <span class="math inline">\(w_1\)</span> was rotated together with <span class="math inline">\(w_4\)</span> and <span class="math inline">\(w_2\)</span> was rotated together with <span class="math inline">\(w_5\)</span>. Figure <a href="implementation.html#fig:cov-plot-print-1">3</a> visualize the covariance structure and relationship between the response and predictor variables for first design.</p>

<div class="figure"><span id="fig:cov-plot-print-1"></span>
<img src="main_files/figure-html/cov-plot-print-1-1.svg" alt="Simulation of predictor and response variables for design one after orthogonal transformation of predictor and response components by rotation matrices \(Q\) and \(R\) shown as the upper left and the lower right block matrices in (b). Here (a) is the covariance structure of latent space which is rotated by the block diagonal rotation matrix in (b) resulting the covariance structure of simulated data in (c)." width="33%" /><img src="main_files/figure-html/cov-plot-print-1-2.svg" alt="Simulation of predictor and response variables for design one after orthogonal transformation of predictor and response components by rotation matrices \(Q\) and \(R\) shown as the upper left and the lower right block matrices in (b). Here (a) is the covariance structure of latent space which is rotated by the block diagonal rotation matrix in (b) resulting the covariance structure of simulated data in (c)." width="33%" /><img src="main_files/figure-html/cov-plot-print-1-3.svg" alt="Simulation of predictor and response variables for design one after orthogonal transformation of predictor and response components by rotation matrices \(Q\) and \(R\) shown as the upper left and the lower right block matrices in (b). Here (a) is the covariance structure of latent space which is rotated by the block diagonal rotation matrix in (b) resulting the covariance structure of simulated data in (c)." width="33%" />
<p class="caption">
Figure 3: Simulation of predictor and response variables for design one after orthogonal transformation of predictor and response components by rotation matrices <span class="math inline">\(Q\)</span> and <span class="math inline">\(R\)</span> shown as the upper left and the lower right block matrices in (b). Here (a) is the covariance structure of latent space which is rotated by the block diagonal rotation matrix in (b) resulting the covariance structure of simulated data in (c).
</p>
</div>
<table style="width:100%;">
<caption><span id="tab:parameter-settings">Table 1: </span> Parameter setting of simulated data for comparison of estimation methods</caption>
<colgroup>
<col width="40%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"> </th>
<th align="right">Design1</th>
<th align="right">Design2</th>
<th align="right">Design3</th>
<th align="right">Design4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><strong>Decay of eigenvalues <span class="math inline">\((\gamma)\)</span></strong></td>
<td align="right">0.2</td>
<td align="right">0.8</td>
<td align="right">0.2</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="right"><strong>Coef. of Determination <span class="math inline">\((\rho^2_{w_j})\)</span></strong></td>
<td align="right">0.8, 0.8, 0.4</td>
<td align="right">0.8, 0.8, 0.4</td>
<td align="right">0.4, 0.4, 0.4</td>
<td align="right">0.4, 0.4, 0.4</td>
</tr>
</tbody>
</table>
<p>For each method, an estimate of expected squared prediction error was computed as,</p>
<p><span class="math display">\[\underset{m \times m}{\boldsymbol{\vartheta}} =
\mathrm{E}\left[\left(
\hat{\boldsymbol{\beta}} - \boldsymbol{\beta}
\right) ^t \boldsymbol{\Sigma}_{xx}
\left(
\hat{\boldsymbol{\beta}} - \boldsymbol{\beta}
\right)\right] + \boldsymbol{\Sigma}_{y|x}\]</span></p>
<p>where, <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> is an estimate of true regression coefficient <span class="math inline">\(\boldsymbol{\beta}\)</span> and <span class="math inline">\(\boldsymbol{\Sigma}_{xx}\)</span> is the true covariance structure of the predictor variables obtained from <code>simrel</code>. Also, <span class="math inline">\(\boldsymbol{\Sigma}_{y|x}\)</span> is the true minimum error of the model. Here <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> varies across different estimation methods while the remaining terms are same for each dataset design. Further, an overall prediction error of all responses is measured by the trace of <span class="math inline">\(\boldsymbol{\vartheta}\)</span>.</p>
<p>The minimum prediction error (measured as discussed above) for nine estimation methods averaged over 20 replications of four designs are shown in Table <a href="implementation.html#tab:min-error">2</a>. The table also gives the number of predictor components (response components in case of <code>Yenv</code>), a method has used in order to obtain the minimum of average prediction error.</p>
<table>
<caption><span id="tab:min-error">Table 2: </span> Minimum average prediction error (number of components corresponding to minimum prediction error, minimum prediction error) (For <span class="math inline">\(Y\text{env}\)</span>, the number of response components is given)</caption>
<colgroup>
<col width="10%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center">Design: 1</th>
<th align="center">Design: 2</th>
<th align="center">Design: 3</th>
<th align="center">Design: 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><em>CPLS</em></td>
<td align="center"><code>(3, 3.24)</code></td>
<td align="center"><code>(4, 3.22)</code></td>
<td align="center"><code>(3, 4.09)</code></td>
<td align="center"><code>(3, 4.05)</code></td>
</tr>
<tr class="even">
<td align="left"><em>CPPLS</em></td>
<td align="center"><code>(3, 3.21)</code></td>
<td align="center"><code>(3, 3.17)</code></td>
<td align="center"><code>(3, 4.11)</code></td>
<td align="center"><strong><em><code>(3, 4.04)</code></em></strong></td>
</tr>
<tr class="odd">
<td align="left"><em>OLS</em></td>
<td align="center"><code>(1, 3.60)</code></td>
<td align="center"><code>(1, 3.58)</code></td>
<td align="center"><code>(1, 4.57)</code></td>
<td align="center"><code>(1, 4.50)</code></td>
</tr>
<tr class="even">
<td align="left"><em>PCR</em></td>
<td align="center"><code>(7, 3.28)</code></td>
<td align="center"><code>(6, 3.19)</code></td>
<td align="center"><strong><em><code>(6, 4.08)</code></em></strong></td>
<td align="center"><code>(6, 4.04)</code></td>
</tr>
<tr class="odd">
<td align="left"><em>PLS1</em></td>
<td align="center"><code>(2, 3.32)</code></td>
<td align="center"><code>(5, 3.20)</code></td>
<td align="center"><code>(1, 4.16)</code></td>
<td align="center"><code>(5, 4.07)</code></td>
</tr>
<tr class="even">
<td align="left"><em>PLS2</em></td>
<td align="center"><code>(5, 3.29)</code></td>
<td align="center"><code>(6, 3.19)</code></td>
<td align="center"><code>(3, 4.11)</code></td>
<td align="center"><code>(6, 4.06)</code></td>
</tr>
<tr class="odd">
<td align="left"><em>Senv</em></td>
<td align="center"><strong><em><code>(4, 3.17)</code></em></strong></td>
<td align="center"><strong><em><code>(5, 3.14)</code></em></strong></td>
<td align="center"><code>(3, 4.35)</code></td>
<td align="center"><code>(5, 4.28)</code></td>
</tr>
<tr class="even">
<td align="left"><em>Xenv</em></td>
<td align="center"><code>(5, 3.23)</code></td>
<td align="center"><code>(6, 3.20)</code></td>
<td align="center"><code>(5, 4.10)</code></td>
<td align="center"><code>(6, 4.11)</code></td>
</tr>
<tr class="odd">
<td align="left"><em>Yenv</em></td>
<td align="center"><code>(3, 3.24)</code></td>
<td align="center"><code>(3, 3.23)</code></td>
<td align="center"><code>(3, 4.29)</code></td>
<td align="center"><code>(3, 4.24)</code></td>
</tr>
</tbody>
</table>
<p>Table <a href="implementation.html#tab:min-error">2</a> shows that the simultaneous envelope has prediction error of 3.17 and 3.14 in design 1 (with 4 components) and design 2 (with 5 components), respectively, which is smaller than other methods. However the method was not able to show the same performance in design 3 and design 4. The PCR model has the smallest prediction error (4.08) from 6 components in design 3 and Canonically Powered PLS has minimum prediction error (4.04) from 3 components in design 4. In design 3, we can also see that the Canonical PLS method has second best performance with only three components. The number of components vary across different replicated dataset but the component corresponding to minimum prediction error is discussed here. A detailed picture of prediction error for each estimation method obtained for each additional component is shown in Figure <a href="implementation.html#fig:Average-Prediction-Plot">4</a>. Although designs 2 and 4 have higher levels of multicollinearity, the performance of the estimation methods is indifferent to its effect. Since all the methods, except OLS, are based on shrinking of estimates, they are less influenced by the multicollinearity problem.</p>
<div class="figure"><span id="fig:Average-Prediction-Plot"></span>
<img src="main_files/figure-html/Average-Prediction-Plot-1.svg" alt="Minimum of Average Prediction Error" width="100%" />
<p class="caption">
Figure 4: Minimum of Average Prediction Error
</p>
</div>
<p>The analysis presented in Figure <a href="implementation.html#fig:Average-Prediction-Plot">4</a> has addressed some questions such as how methods work when there exist a true reduced dimension in response space, but also arose other questions like why they perform differently. For example, what is the reason for the decreasing relative performance of the simultaneous envelope method as the <span class="math inline">\(\rho^2\)</span> values are reduced? Does this depend on the dimensions and shape of the <span class="math inline">\(\mathbf{y}\)</span> envelopes? Since, the example is merely intended as a demonstration of how <code>simrel</code> can be used in scientific study, a more elaborative studies would be necessary to answer such questions, but for this purpose <code>simrel</code> would be a powerful tool.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="relevant-components.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="web-interface.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": true,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/therimalaya/simrel-m/edit/master/Includes/03-Implementation.Rmd",
"text": "Edit"
},
"download": ["main.epub", "main.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
