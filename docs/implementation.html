<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>simrel-m: A versatile tool for simulating multi-response linear model data</title>
  <meta name="description" content="<code>simrel-m</code>: A versatile tool for simulating multi-response linear model data">
  <meta name="generator" content="bookdown 0.3.18 and GitBook 2.6.7">

  <meta property="og:title" content="simrel-m: A versatile tool for simulating multi-response linear model data" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://therimalaya.github.io/simrel-m" />
  
  
  <meta name="github-repo" content="therimalaya/simrel-m" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="simrel-m: A versatile tool for simulating multi-response linear model data" />
  
  
  



<meta name="date" content="2017-06-20">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="relevant-components.html">
<link rel="next" href="web-interface.html">
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="lead"><a href="./index.html">Simrel-M: A versatile Simulation Tool</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="statistical-model.html"><a href="statistical-model.html"><i class="fa fa-check"></i>Statistical Model</a></li>
<li class="chapter" data-level="" data-path="relevant-components.html"><a href="relevant-components.html"><i class="fa fa-check"></i>Relevant Components</a><ul>
<li class="chapter" data-level="" data-path="relevant-components.html"><a href="relevant-components.html#model-parameterization"><i class="fa fa-check"></i>Model Parameterization</a><ul>
<li class="chapter" data-level="" data-path="relevant-components.html"><a href="relevant-components.html#position-of-relevant-components"><i class="fa fa-check"></i>Position of relevant components</a></li>
<li class="chapter" data-level="" data-path="relevant-components.html"><a href="relevant-components.html#data-simulation"><i class="fa fa-check"></i>Data Simulation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="relevant-components.html"><a href="relevant-components.html#rotation-of-predictor-space"><i class="fa fa-check"></i>Rotation of predictor space</a></li>
<li class="chapter" data-level="" data-path="relevant-components.html"><a href="relevant-components.html#rotation-of-response-space"><i class="fa fa-check"></i>Rotation of response space</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="implementation.html"><a href="implementation.html"><i class="fa fa-check"></i>Implementation</a></li>
<li class="chapter" data-level="" data-path="web-interface.html"><a href="web-interface.html"><i class="fa fa-check"></i>Web Interface</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li class="toc-footer"><a href="https://bookdown.org" target="blank">Published with BookDown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><code>simrel-m</code>: A versatile tool for simulating multi-response linear model data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="implementation" class="section level1">
<h1>Implementation</h1>
<p>This section demonstrates an application of <code>simrel-m</code> in order to compare different estimation methods on the basis of prediction error. For the comparison, we have considered four well established estimation methods.</p>
<ol style="list-style-type: lower-alpha">
<li>Ordinary Least Squares (OLS),</li>
<li>Principal Component Regression (PCR),</li>
<li>Partial Least Squares predicting individual response variable separately (PLS1) and</li>
<li>Partial Least Squares predicting all response variables together (PLS).</li>
</ol>
<p>We have also considered four relatively new estimation methods</p>
<ol style="list-style-type: lower-alpha">
<li>Canonically Powered Partial Least Squares regression (CPPLS) <span class="citation">(Indahl, Liland, and Næs <a href="#ref-indahl2009canonical">2009</a>)</span>,</li>
<li>Canonical Partial Least Squares regression (CPLS) <span class="citation">(Indahl, Liland, and Næs <a href="#ref-indahl2009canonical">2009</a>)</span>,</li>
<li>Envelope estimation in predictor space (xenv) <span class="citation">(Cook, Li, and Chiaromonte <a href="#ref-cook2010envelope">2010</a>)</span>,</li>
<li>Envelope estimation in response space (yenv) <span class="citation">(R. D. Cook and Zhang <a href="#ref-cook2015foundations">2015</a><a href="#ref-cook2015foundations">a</a>)</span> and</li>
<li>Simultaneous estimation of x- and y-envelope (senv) <span class="citation">(R. D. Cook and Zhang <a href="#ref-cook2015simultaneous">2015</a><a href="#ref-cook2015simultaneous">b</a>)</span></li>
</ol>
<p>From the possible combinations of two levels of coefficient of determination <span class="math inline">\((R^2)\)</span> and two levels of <code>gamma</code> (factor that controls the multicollinearity in predictor variable), four simulation designs (design 1, design 2, design 3, design 4) are prepared. Replicating each design 20 times, 80 datasets with five response variables <span class="math inline">\((m=5)\)</span> and 16 predictor variables <span class="math inline">\((p = 16)\)</span> are simulated using the method discussed in this paper. It is also assumed that three principle components of response variables (<span class="math inline">\(w_1, w_2\)</span> and <span class="math inline">\(w_3\)</span>) completely describes the variation present in five response variables (<span class="math inline">\(y_1 \ldots y_5\)</span>). The four designs are presented in the Table~<a href="implementation.html#tab:parameter-settings">1</a>. All datasets contains 100 sample observations and out of 16 predictor variables, three disjoint set of five predictor variables are relevant for response components <span class="math inline">\(w_1, w_2\)</span> and <span class="math inline">\(w_3\)</span>. Further, predictor components <span class="math inline">\(z_1\)</span> and <span class="math inline">\(z_6\)</span> are relevant for response component <span class="math inline">\(w_1\)</span>, predictor components <span class="math inline">\(z_2\)</span> and <span class="math inline">\(z_5\)</span> are relevant for response component <span class="math inline">\(w_2\)</span> and predictor component <span class="math inline">\(z_3\)</span> is relevant for response component <span class="math inline">\(w_3\)</span>. In addition, following the discussion about <a href="relevant-components.html#rotation-of-response-space">rotation of response space</a>, <span class="math inline">\(w_1\)</span> is rotated together with <span class="math inline">\(w_4\)</span> and <span class="math inline">\(w_2\)</span> is rotated together with <span class="math inline">\(w_5\)</span>.</p>
<table>
<caption><span id="tab:parameter-settings">Table 1: </span> Parameter setting of simulated data for model comparison</caption>
<colgroup>
<col width="41%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"> </th>
<th align="right">Design1</th>
<th align="right">Design2</th>
<th align="right">Design3</th>
<th align="right">Design4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><strong>Decay of eigenvalue <span class="math inline">\((\gamma)\)</span></strong></td>
<td align="right">0.2</td>
<td align="right">0.8</td>
<td align="right">0.2</td>
<td align="right">0.8</td>
</tr>
<tr class="even">
<td align="right"><strong>Coef. of Determination <span class="math inline">\((\rho^2)\)</span></strong></td>
<td align="right">0.8, 0.8, 0.4</td>
<td align="right">0.8, 0.8, 0.4</td>
<td align="right">0.4, 0.4, 0.4</td>
<td align="right">0.4, 0.4, 0.4</td>
</tr>
</tbody>
</table>
<p>For each method, an estimate of test prediction error is computed as,</p>
<p><span class="math display">\[\underset{m \times m}{\boldsymbol{\alpha}} = 
\left(
\hat{\boldsymbol{\beta}} - \boldsymbol{\beta}
\right) ^t \boldsymbol{\Sigma}_{xx}
\left(
\hat{\boldsymbol{\beta}} - \boldsymbol{\beta}
\right) + \boldsymbol{\sigma}^2\]</span></p>
<p>where, <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> is an estimate of true regression coefficient <span class="math inline">\(\boldsymbol{\beta}\)</span> and <span class="math inline">\(\boldsymbol{\Sigma}_{xx}\)</span> is the true covariance structure of predictor variable obtained from <code>simrel-m</code>. Also, <span class="math inline">\(\boldsymbol{\sigma}^2\)</span> is the true minimum error of the model. Here <span class="math inline">\(\hat{\beta}\)</span> vary accross different estimation methods while the remaining terms are same for each dataset design. Further, an overall prediction error of all responses is measured by the trace of <span class="math inline">\(\alpha\)</span>, i.e. <span class="math inline">\(\text{tr}(\alpha)\)</span>.</p>
<p>The minimimum prediction error (measured as discussed above) for nine estimation methods averaged over 20 replications of four designs are in Table~<a href="implementation.html#tab:min-error">2</a>. The table also shows that the number of components a method has used in order to obtain the minimum of average prediciton error.</p>
<center>
<table>
<caption><span id="tab:min-error">Table 2: </span> Minimum average prediction error (number of components, prediction error)</caption>
<colgroup>
<col width="10%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center">Design: 1</th>
<th align="center">Design: 2</th>
<th align="center">Design: 3</th>
<th align="center">Design: 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><em>CPLS</em></td>
<td align="center"><code>(3, 3.24)</code></td>
<td align="center"><code>(4, 3.22)</code></td>
<td align="center"><code>(3, 4.09)</code></td>
<td align="center"><code>(3, 4.05)</code></td>
</tr>
<tr class="even">
<td align="left"><em>CPPLS</em></td>
<td align="center"><code>(3, 3.21)</code></td>
<td align="center"><code>(3, 3.17)</code></td>
<td align="center"><code>(3, 4.11)</code></td>
<td align="center"><strong><em><code>(3, 4.04)</code></em></strong></td>
</tr>
<tr class="odd">
<td align="left"><em>OLS</em></td>
<td align="center"><code>(1, 3.6)</code></td>
<td align="center"><code>(1, 3.58)</code></td>
<td align="center"><code>(1, 4.57)</code></td>
<td align="center"><code>(1, 4.5)</code></td>
</tr>
<tr class="even">
<td align="left"><em>PCR</em></td>
<td align="center"><code>(7, 3.28)</code></td>
<td align="center"><code>(6, 3.19)</code></td>
<td align="center"><strong><em><code>(6, 4.08)</code></em></strong></td>
<td align="center"><code>(6, 4.04)</code></td>
</tr>
<tr class="odd">
<td align="left"><em>PLS</em></td>
<td align="center"><code>(5, 3.29)</code></td>
<td align="center"><code>(6, 3.19)</code></td>
<td align="center"><code>(3, 4.11)</code></td>
<td align="center"><code>(6, 4.06)</code></td>
</tr>
<tr class="even">
<td align="left"><em>PLS1</em></td>
<td align="center"><code>(2, 3.32)</code></td>
<td align="center"><code>(5, 3.2)</code></td>
<td align="center"><code>(1, 4.16)</code></td>
<td align="center"><code>(5, 4.07)</code></td>
</tr>
<tr class="odd">
<td align="left"><em>Senv</em></td>
<td align="center"><strong><em><code>(4, 3.17)</code></em></strong></td>
<td align="center"><strong><em><code>(5, 3.14)</code></em></strong></td>
<td align="center"><code>(3, 4.35)</code></td>
<td align="center"><code>(5, 4.28)</code></td>
</tr>
<tr class="even">
<td align="left"><em>Xenv</em></td>
<td align="center"><code>(5, 3.23)</code></td>
<td align="center"><code>(6, 3.2)</code></td>
<td align="center"><code>(5, 4.1)</code></td>
<td align="center"><code>(6, 4.11)</code></td>
</tr>
<tr class="odd">
<td align="left"><em>Yenv</em></td>
<td align="center"><code>(3, 3.24)</code></td>
<td align="center"><code>(3, 3.23)</code></td>
<td align="center"><code>(3, 4.29)</code></td>
<td align="center"><code>(3, 4.24)</code></td>
</tr>
</tbody>
</table>
</center>
<p>Table~<a href="implementation.html#tab:min-error">2</a> shows that simulteneous envelope has prediction error of 3.17 and 3.14 in design 1 and design 2 respectively which is smaller than other methods. However the model was not able to show the same performance in design 3 and design 4. Cannonical PLS and Cannonically Powered PLS has out performed other methods in these designs. Here, the difference between CPLS and CPPLS is minimal. These methods has also shown a fair performance in the first two designs with only three components. A detail picture of prediction error for each estimation method obtained for each additional component is shown in Figure~<a href="implementation.html#fig:Average-Prediction-Plot">3</a>. Although design 2 and design 4 has higher level of multicollinearity, the performance of the estimation methods is indifferent to its effect. Since all the methods, except OLS, are based on shrinking of estimates, they are less influenced by multicollinearity problem.</p>
<div class="figure"><span id="fig:Average-Prediction-Plot"></span>
<img src="Simrel-M_files/figure-html/Average-Prediction-Plot-1.svg" alt="Minimum of Average Prediction Error" width="100%" />
<p class="caption">
Figure 3: Minimum of Average Prediction Error
</p>
</div>
<p>Above analysis has answered some questions such as how methods works when there exist a true reduced dimension in response space but also arised question like why they perform differently. For example, the reduced performance of simulteneous envelope going from design with <span class="math inline">\(R^2 = (0.8, 0.8, 0.4)\)</span> to design with <span class="math inline">\(R^2 = (0.4, 0.4, 0.4)\)</span> has arised question such as – Does the performance of the method depends on <span class="math inline">\(R^2\)</span> or it is a random situation? Since, this paper is intended for a demonstration of how <code>simrel-m</code> can be used in scientific study, a more elaborative study is needed in order to answer such question which <code>simrel-m</code> can help as an useful instrument.</p>

</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-indahl2009canonical">
<p>Indahl, Ulf G, Kristian Hovde Liland, and Tormod Næs. 2009. “Canonical Partial Least Squares–a Unified Pls Approach to Classification and Regression Problems.” <em>Journal of Chemometrics</em> 23 (9). Wiley Online Library: 495–504.</p>
</div>
<div id="ref-cook2010envelope">
<p>Cook, R Dennis, Bing Li, and Francesca Chiaromonte. 2010. “Envelope Models for Parsimonious and Efficient Multivariate Linear Regression.” <em>Statistica Sinica</em>. JSTOR, 927–60.</p>
</div>
<div id="ref-cook2015foundations">
<p>Cook, R Dennis, and Xin Zhang. 2015a. “Foundations for Envelope Models and Methods.” <em>Journal of the American Statistical Association</em> 110 (510). Taylor &amp; Francis: 599–611.</p>
</div>
<div id="ref-cook2015simultaneous">
<p>Cook, R Dennis, and Xin Zhang. 2015b. “Simultaneous Envelopes for Multivariate Linear Regression.” <em>Technometrics</em> 57 (1). Taylor &amp; Francis: 11–25.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="relevant-components.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="web-interface.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": true,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/therimalaya/simrel-m/edit/master/Includes/03-Implementation.Rmd",
"text": "Edit"
},
"download": ["Simrel-M.epub", "Simrel-M.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
