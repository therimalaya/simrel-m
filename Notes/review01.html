<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Raju Rimal">
  <title>Review on Simrel Paper</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  
  
  
  <link rel="stylesheet" href="latex.css"/>
  <link rel="stylesheet" href="tufte.css"/>
  <link rel="stylesheet" href="custom.css"/>
  
</head>
<body>
<header>
<h1 class="title">Review on Simrel Paper</h1>
<p class="author">Raju Rimal</p>
</header>
<p style="display:inline"><strong>Reference to the line or paragraph:</p> </strong><strong>Small Bold Text</strong>
<p><strong>Comments:</strong> <em>italics</em></p>
<p><strong>Actual changes:</strong> Normal text</p>
<h1 id="corrections-in-paper"><span class="done DONE">DONE</span> Corrections in Paper</h1>
<h2 id="introduction">Introduction</h2>
<h3 id="page-2">Page 2:</h3>
<p><em>Reference added <span class="citation" data-cites="johnson2013multivariate">(Johnson 2013)</span> along with <span class="citation" data-cites="ripley2009stochastic">(Ripley 2009)</span> and <span class="citation" data-cites="gamerman2006markov">(Gamerman and Lopes 2006)</span>.</em></p>
<dl>
<dt><strong>Line 2 last paragraph</strong></dt>
<dd>
</dd>
</dl>
<p>In particular, methods based on covariance structure has been discussed by <span class="citation" data-cites="arteaga2010simulate">(Arteaga and Ferrer 2010, <span class="citation" data-cites="arteaga2013building">Arteaga and Ferrer (2013)</span>, <span class="citation" data-cites="camacho2017generation">Camacho (2017)</span>)</span>, which follow an algorithmic approach to find simulated data satisfying the desired correlation structure.</p>
<h3 id="page-3">Page 3:</h3>
<dl>
<dt><strong>After first Paragraph</strong></dt>
<dd>
</dd>
</dl>
<p>The github repository of the package at <a href="http://github.com/simulatr/simrel" class="uri">http://github.com/simulatr/simrel</a> has rich documentation with many examples and cases along with detail description of simulation parameters. In the following two sections, the discussion encircle the mathematical framework behind. In addition, in section-4 and 5 we have also discussed the input parameters needed for simrel function in brief. In section 4, an implementation is presented as an example of use-cases and the final section introduces the shiny web application for this tool.</p>
<dl>
<dt><strong>Last Paragraph (Coefficient of Determination)</strong></dt>
<dd>
</dd>
</dl>
<p><del><strong>Coefficient of Determination</strong> The diagonal elements of the coefficient-of-determination matrix <span class="math inline">\(\cancel{\boldsymbol{\rho}_y^2 (m \times m)}\)</span> give the amount of variation in each response variable that is explained by <span class="math inline">\(\mathbf{x}\)</span>.</del> <span class="math display">\[\cancel{\boldsymbol{\rho}_y^2 = \boldsymbol{\Sigma}_{yx}\boldsymbol{\Sigma}_{xx}^{-1}\boldsymbol{\Sigma}_{xy}\boldsymbol{\Sigma}_{yy}^{-1}}\]</span> <strong>Coefficient of Determination</strong> Since, a matrix of coefficient-of-determination represents the proportion of variation explained by the predictors, we can write this matrix as, <span class="math display">\[
\left(\rho_y^2\right)_{jj&#39;} =
\frac{\sigma_{xy_j}^t\Sigma_{xx}^{-1}\sigma_{xy_{j&#39;}}}
    {\sqrt{\sigma_{y_j}^2\sigma_{y_{j&#39;}}^2}} \forall j, j&#39; = 1 \ldots m
\]</span> where, <span class="math inline">\(\sigma_{xy_j}\)</span>, <span class="math inline">\(\sigma_{xy_{j&#39;}}\)</span> are covariance between <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(y_j\)</span>, <span class="math inline">\(y_{j&#39;}\)</span> respectively. Also, <span class="math inline">\(\sigma_{y_j}^2\)</span> and <span class="math inline">\(\sigma_{y_{j&#39;}}^2\)</span> are unconditional variances of <span class="math inline">\(y_j\)</span> and <span class="math inline">\(y_{j&#39;}\)</span>.</p>
<p>Here the numerator gives the variation that <span class="math inline">\(\mathbf{x}\)</span> explained which is equivalent to the covariance of fitted <span class="math inline">\(\mathbf{y}\)</span> in sample space. The denominator gives the total variation present in <span class="math inline">\(\mathbf{y}\)</span>. The diagonal element of this matrix is the proportion of variation in a response <span class="math inline">\(y_j, j = 1, \ldots m\)</span> explained by the predictor.</p>
<h3 id="page-5">Page 5:</h3>
<p><del><strong>Coefficient of Determination</strong> The coefficient-of-determination matrix for (4) is</del> <span class="math display">\[
  \cancel{\begin{aligned}
    \boldsymbol{\rho}^2_w &amp;= \boldsymbol{\Sigma}_{wz}
    \boldsymbol{\Sigma}_{zz}^{-1} \boldsymbol{\Sigma}_{zw}
    \boldsymbol{\Sigma}_{ww}^{-1} \\
  &amp;=\mathbf{Q}
  \boldsymbol{\Sigma}_{yx}\mathbf{R}^t \left(\mathbf{R}\boldsymbol{\Sigma}_{xx}\mathbf{R}^t\right)^{-1}
  \mathbf{R}\boldsymbol{\Sigma}_{xy}\mathbf{Q}^t \left(\mathbf{Q} \boldsymbol{\Sigma}_{yy}^{-1} \mathbf{Q}^t\right) \nonumber \\ &amp;=\mathbf{Q}\left[\boldsymbol{\Sigma}_{yx}\boldsymbol{\Sigma}_{xx}\boldsymbol{\Sigma}_{xy}\boldsymbol{\Sigma}_{yy}^{-1}\right]\mathbf{Q}
  = \mathbf{Q}\boldsymbol{\rho}_{y}^2 \mathbf{Q}^t
  \end{aligned}}
  \]</span> <strong>Coefficient of Determination</strong> The coefficient-of-determination matrix corresponding to <span class="math inline">\(\mathbf{w}\)</span> can be written as, <span class="math display">\[
\begin{aligned}
\left(\rho_w^2\right)_{j{j&#39;}} &amp;=
  \boldsymbol{\Sigma}_{ww}^{-1/2}
  \boldsymbol{\Sigma}_{wz}
  \boldsymbol{\Sigma}_{zz}^{-1} 
  \boldsymbol{\Sigma}_{zw}
  \boldsymbol{\Sigma}_{ww}^{-1/2} \\ &amp;=
 \frac{\sigma_{zw_i}^t\Sigma_{zz}^{-1}\sigma_{zw_{j&#39;}}}
    {\sqrt{\sigma_{w_j}^2\sigma_{w_{j&#39;}}^2}} \forall j, {j&#39;} = 1 \ldots m
\end{aligned}
\]</span> where, <span class="math inline">\(\sigma_{zw_j}\)</span> and <span class="math inline">\(\sigma_{zw_{j&#39;}}\)</span> are covariances of <span class="math inline">\(\mathbf{z}\)</span> with <span class="math inline">\(w_j\)</span> and <span class="math inline">\(w_{j&#39;}\)</span> respectively. Also, <span class="math inline">\(\sigma_{w_j}^2\)</span> and <span class="math inline">\(\sigma_{w_{j&#39;}}^2\)</span> are unconditional variances of <span class="math inline">\(w_j\)</span> and <span class="math inline">\(w_{j&#39;}\)</span>. For simplicity, we will denote <span class="math inline">\(\sigma_{z_iw_j}\)</span> by <span class="math inline">\(\sigma_{ij}\)</span>.</p>
<p>Since the rotation matrices gives direct connection between the covariance of (1) and (3), a straight forward relationship can be imagined between the termes in above matrix with their counterpart covariance matrices of <span class="math inline">\(\mathbf{xy}\)</span>-space.</p>
<h2 id="relevant-components">Relevant Components</h2>
<h3 id="page-6">Page 6</h3>
<p><em>Equation number has been added to the expression of generating lambda from gamma. Subscript changed from <span class="math inline">\(j\)</span> to <span class="math inline">\(i\)</span>.</em></p>
<dl>
<dt><strong>Added to equation of</strong> <span class="math inline">\(\gamma\)</span></dt>
<dd>
</dd>
</dl>
<p>Hence, we can write <span class="math inline">\(\Sigma_{zz} = \Lambda = \text{diag}(\lambda_1, \ldots, \lambda_p)\)</span>.</p>
<dl>
<dt><strong>Parameterization of</strong> <span class="math inline">\(\Sigma_{ww}\)</span></dt>
<dd>
</dd>
</dl>
<p><del>Here we assume that <span class="math inline">\(\mathbf{w}\)</span>'s are independent and has mutinormal distribution wnith variances 1, hence <span class="math inline">\(\boldsymbol{\Sigma}_{ww} = \mathbf{I}_m\)</span>.</del> In similar manner, a parametric representation of eigenvalues corresponding to <span class="math inline">\(\Sigma_{ww}\)</span> is adopted as, <span class="math display">\[\kappa_j = e^{-\eta(j - 1), \eta &gt; 0 \text{ and } j = 1 \ldots m}\]</span> Here, the decline of eigenvalues becomes steeper as <span class="math inline">\(\eta\)</span> increases from zero. At <span class="math inline">\(\eta = 0\)</span>, all <span class="math inline">\(w\)</span> will have equal variance. Hence we can write <span class="math inline">\(\Sigma_{ww} = \text{diag}(\kappa_1, \ldots, \kappa_m)\)</span>.</p>
<h3 id="page-8">Page 8</h3>
<dl>
<dt><strong>Paragraph 2</strong></dt>
<dd>
</dd>
</dl>
<p><span class="math display">\[
  \cancel{\boldsymbol{\rho}_w^2 = 
  \boldsymbol{\Sigma}_{zw}^t
  \boldsymbol{\Sigma}_{zz}^{-1}
  \boldsymbol{\Sigma}_{zw}
  \boldsymbol{\Sigma}_{ww}^{-1}}
\]</span> <span class="math display">\[
    \begin{aligned}
      \boldsymbol{\rho}_w^2 &amp;= 
      \boldsymbol{\Sigma}_{ww}^{-1/2}
      \boldsymbol{\Sigma}_{zw}^t
      \boldsymbol{\Sigma}_{zz}^{-1}
      \boldsymbol{\Sigma}_{zw}
      \boldsymbol{\Sigma}_{ww}^{-1/2} \\ &amp;=
      \frac{\sigma_{ij}^t\Lambda^{-1}\sigma_{ij&#39;}}
          {\sqrt{\sigma_{j}^2\sigma_{j&#39;}^2}} \forall j, {j&#39;} = 1 \ldots m
    \end{aligned}
\]</span></p>
<dl>
<dt><strong>Paragraph 3</strong></dt>
<dd>
</dd>
</dl>
<p>h<span class="math inline">\(\cancel{\Sigma_{ww} = \mathbf{I}_{m}}\)</span> <span class="math display">\[\Sigma_{ww} = \text{diag}(\kappa_1, \ldots, \kappa_m)\]</span></p>
<dl>
<dt><strong>Paragraph 4</strong></dt>
<dd><span class="math inline">\(\cancel{\rho_w^2 = \Sigma_{zw}^t\Lambda^{-1}\Sigma_{zw}\Sigma_{ww}^{-1}}\)</span>
</dd>
</dl>
<p><span class="math display">\[\rho_{w}^2 = \Sigma_{ww}^{-1/2}\Sigma_{zw}^t\Lambda^{-1}\Sigma_{zw}\Sigma_{ww}^{-1/2} = 
\begin{bmatrix}
  \displaystyle\sum_{i = 1}^p\dfrac{\sigma_{i1}^2}{\lambda_i\kappa_1} &amp; 
  \ldots &amp;
  \displaystyle\sum_{i=1}^p\dfrac{\sigma_{i1}\sigma_{im}}{\lambda_i\sqrt{\kappa_1\kappa_m}} \\
  \vdots &amp; \ddots &amp; \vdots \\
  \displaystyle\sum_{i=1}^p\dfrac{\sigma_{i1}\sigma_{im}}{\lambda_i\sqrt{\kappa_1\kappa_m}} &amp; 
  \ldots &amp; 
  \displaystyle\sum_{i = 1}^p\dfrac{\sigma_{im}^2}{\lambda_i\kappa_m}
\end{bmatrix}\]</span></p>
<dl>
<dt><strong>Paragraph 6</strong></dt>
<dd>
</dd>
</dl>
<p><span class="math inline">\(\cancel{\rho_{w_j}^2 = \sum_{i = 1}^p\frac{\sigma_{ij}^2}{\lambda_i}}\)</span> <span class="math display">\[\rho_{w_j}^2 = \sum_{i = 1}^p\frac{\sigma_{ij}^2}{\lambda_i\kappa_j}\]</span></p>
<dl>
<dt><strong>Paragraph 8</strong></dt>
<dd>
</dd>
</dl>
<p><span class="math inline">\(\cancel{\rho_{w_j}^2 = \sum_{i \in \mathcal{P}_j}\frac{\sigma_{ij}^2}{\lambda_i}}\)</span> <span class="math display">\[\rho_{w_j}^2 = \sum_{i \in \mathcal{P}_j} \frac{\sigma_{ij}^2}{\lambda_i\kappa_j}\]</span></p>
<dl>
<dt><strong>Paragraph 12 (last display equation)</strong></dt>
<dd>
</dd>
</dl>
<p><span class="math inline">\(\cancel{\sigma_{ij} = \text{Sign}(\mathcal{S}_i)\sqrt{\frac{\rho_{wj}^2\left|\mathcal{S}_i\right|}{\sum_{k\in\mathcal{P}_j}\left|\mathcal{S}_k\right|}\lambda_i}}\)</span> <span class="math display">\[\sigma_{ij} = \text{Sign}(\mathcal{S}_i)\sqrt{\frac{\rho_{wj}^2\left|\mathcal{S}_i\right|}{\sum_{k\in\mathcal{P}_j}\left|\mathcal{S}_k\right|}\lambda_i\kappa_j}\]</span> for <span class="math inline">\(i \in \mathcal{P}_j\)</span> and <span class="math inline">\(j = 1, \ldots m\)</span></p>
<h2 id="implementation">Implementation</h2>
<h3 id="page-13">Page 13</h3>
<p><del><code>gamma</code></del> <span class="math inline">\(\gamma\)</span> <em>(referred to corresponding equation)</em></p>
<dl>
<dt><strong>Line 8</strong></dt>
<dd>
</dd>
</dl>
<p>Here, in this example we have assumed that all <span class="math inline">\(w\)</span> 's have equal variance, i.e. <span class="math inline">\(\Sigma_{ww} = I_m\)</span></p>
<dl>
<dt><strong>Line 11</strong></dt>
<dd>
</dd>
</dl>
<p>Although the simulation method is well equipped to simulate data with <span class="math inline">\(p \gg n\)</span>, for incorporating envelope estimation methods which are based on maximization of likelihood, we have chosen a <span class="math inline">\(n &gt; p\)</span> situation in the example.</p>
<dl>
<dt><strong>Figure 3 Caption added</strong></dt>
<dd>
</dd>
</dl>
<p>Here (a) is the covariance structure of the latent space, which is rotated by the block diagonal rotation matrix in (b) resulting the covariance structure of simulated data in (c).</p>
<h2 id="web-interface">Web Interface</h2>
<h3 id="page-16">Page 16</h3>
<dl>
<dt><strong>Last Paragraph</strong></dt>
<dd>
</dd>
</dl>
<p><del>(uses <code>simrel</code> package in CRAN)</del>, <del>(not yet available in CRAN)</del>, <del>(<code>simrel-m</code>)</del>.</p>
<dl>
<dt><strong>second last line</strong></dt>
<dd>
</dd>
</dl>
<p>Users can also download simulated data in JSON and CSV format.</p>
<h3 id="page-17">Page 17</h3>
<dl>
<dt><strong>After first paragraph</strong></dt>
<dd>
</dd>
</dl>
<p>An R expression equivalent to the input parameters as shown in Figure - 5(b) can be written as,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">simrel</span>(
  <span class="dt">n      =</span> <span class="dv">200</span>, <span class="co"># Number of training observations</span>
  <span class="dt">ntest  =</span> <span class="dv">50</span>, <span class="co"># Number of test observations</span>
  <span class="dt">p      =</span> <span class="dv">15</span>, <span class="co"># Number of predictor variables</span>
  <span class="dt">q      =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">4</span>), <span class="co"># Number of relevant predictors</span>
  <span class="dt">relpos =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>)),
        <span class="co"># Relevant predictor components</span>
  <span class="dt">R2     =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, <span class="fl">0.7</span>), <span class="co"># Rsq for each response component</span>
  <span class="dt">m      =</span> <span class="dv">4</span>, <span class="co"># Number of response variables</span>
  <span class="dt">gamma  =</span> <span class="fl">0.6</span>, <span class="co"># Decay factor of eigenvalues of predictors</span>
  <span class="dt">eta    =</span> <span class="dv">0</span>, <span class="co"># Decay factor of eigenvalues of responses</span>
  <span class="dt">ypos   =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)),
        <span class="co"># Combination of response components on rotation</span>
  <span class="dt">type   =</span> <span class="st">&quot;multivariate&quot;</span>
)</code></pre></div>
<p><em>After Second paragraph until conclusion, major changes have been done. In order to make Figure-5 more clear.</em> <em>Figure-5 moved a page before</em></p>
<dl>
<dt><strong>Figure-5 Caption:</strong></dt>
<dd>
</dd>
</dl>
<p>Web interface of shiny application of <code>simrel</code>: (<strong>a</strong>) Buttons to trigger simulation, (<strong>b</strong>) Parameters for simulation, (<strong>c</strong>) Visualization of the true properties of simulated data (regression coefficients, true and estimated covariance between response and predictors components) (<strong>d</strong>) Additional analysis (<strong>e</strong>) Download option of simulated data.</p>
<h3 id="page-18">Page 18</h3>
<p><em>Figure 5 is updated.</em></p>
<h2 id="conclusion">Conclusion</h2>
<p>Whether comparing methods or assessing and understanding the properties of any methods, tool or procedure; simulated data allows for controlled tests for researchers. However, researchers spend enormous amount of time creating such simulation tools so that they can obtain a particular nature of data. We believe that this tool along with the R-package and the easy-to-use shiny web interface will become an assistive tool for researchers in this respect.</p>
<h1 id="r-package-simrel-47"><span class="todo TODO">TODO</span> R package:: <code>simrel</code> [4/7]</h1>
<h1 id="shiny-application-for-simrel-02"><span class="todo TODO">TODO</span> Shiny application for <code>simrel</code> [0/2]</h1>
<h1 id="references" class="unnumbered">References</h1>
<div id="refs" class="references">
<div id="ref-arteaga2010simulate">
<p>Arteaga, Francisco, and Alberto Ferrer. 2010. “How to Simulate Normal Data Sets with the Desired Correlation Structure.” <em>Chemometrics and Intelligent Laboratory Systems</em> 101 (1). Elsevier: 38–42.</p>
</div>
<div id="ref-arteaga2013building">
<p>———. 2013. “Building Covariance Matrices with the Desired Structure.” <em>Chemometrics and Intelligent Laboratory Systems</em> 127. Elsevier: 80–88.</p>
</div>
<div id="ref-camacho2017generation">
<p>Camacho, José. 2017. “On the Generation of Random Multivariate Data.” <em>Chemometrics and Intelligent Laboratory Systems</em> 160. Elsevier: 40–51.</p>
</div>
<div id="ref-gamerman2006markov">
<p>Gamerman, Dani, and Hedibert F Lopes. 2006. <em>Markov Chain Monte Carlo: Stochastic Simulation for Bayesian Inference</em>. CRC Press.</p>
</div>
<div id="ref-johnson2013multivariate">
<p>Johnson, Mark E. 2013. <em>Multivariate Statistical Simulation: A Guide to Selecting and Generating Continuous Multivariate Distributions</em>. John Wiley &amp;amp; Sons.</p>
</div>
<div id="ref-ripley2009stochastic">
<p>Ripley, Brian D. 2009. <em>Stochastic Simulation</em>. Vol. 316. John Wiley &amp; Sons.</p>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    cancel   : ["Extension","cancel"],
    bcancel  : ["Extension","cancel"],
    xcancel  : ["Extension","cancel"],
    cancelto : ["Extension","cancel"]
  });
});
</script>
</body>
</html>
